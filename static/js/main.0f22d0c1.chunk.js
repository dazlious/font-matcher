(this["webpackJsonpfont-matcher"]=this["webpackJsonpfont-matcher"]||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),l=n(11),i=n.n(l),r=(n(18),n(19),n(20),n(9)),o=n.n(r),s=n(7),u=n(4),d=n(12),b=n(3),f=n(2),j=n.n(f),m=n(13),p=n.n(m),h=function(e){return"".concat(e,"px")},x=function(e,t,n){return Math.min(Math.max(e,t),n)},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){return setTimeout(t,e)}))},g=(n(27),n(0)),v="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";j.a.vAlign="top",j.a.align="left",j.a.justify=!1;var y={threshold:.2,includeAA:!0,diffMask:!1},N=500,S=400,w=400,F="Times New Roman",C="none",k="#fff",M="#000",T="#FFF9B3",z="#B3FFCB",R=h(0),B=h(0),W=[0,0,N,S],H=[20,20,460,360],V=function(e){var t=e.getContext("2d");return t.getImageData.apply(t,W).data},A=function(e){var t=e.getContext("2d");return t.clearRect.apply(t,W),t.createImageData(N,S)},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,n=e.getContext("2d");n.clearRect.apply(n,W),n.fillStyle=t,n.fillRect.apply(n,W)},E=function(e,t,n,a){var c=n.fontFamily,l=n.fontSize,i=n.lineHeight,r=n.fontWeight,o=void 0===r?w:r,s=n.textTransform,u=void 0===s?C:s,d=n.letterSpacing,b=void 0===d?R:d,f=n.wordSpacing,m=void 0===f?B:f,p=q(t,u),h=e.getContext("2d");L(e,a),e.style.letterSpacing=b,e.style.wordSpacing=m,h.fillStyle=M,j.a.font=c,j.a.fontWeight=Number(o),j.a.fontSize=Number(l),j.a.lineHeight=Number(i)*Number(l),j.a.drawText.apply(j.a,[h,p].concat(H))},q=function(e,t){switch(t){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();case"none":default:return e}},D=function(e,t,n,a,c){var l=c.fontSize,i=c.lineHeight,r=c.fontWeight,o=void 0===r?w:r,s=c.wordSpacingOriginal,u=void 0===s?B:s,d=c.letterSpacingOriginal,b=void 0===d?R:d,f=c.textTransform,m=void 0===f?C:f,p=c.letterSpacing,h=void 0===p?R:p,x=c.wordSpacing,O=void 0===x?B:x,g=q(t,m),v=e.getContext("2d");L(e,k),v.fillStyle=M,e.style.letterSpacing=b,e.style.wordSpacing=u,j.a.fontWeight=Number(o),j.a.font=n,j.a.fontSize=Number(l),j.a.lineHeight=Number(i)*Number(l),j.a.drawText.apply(j.a,[v,g].concat(H)),e.style.letterSpacing=h,e.style.wordSpacing=O,v.fillStyle="#ff0000",j.a.font=a,j.a.fontWeight=Number(o),j.a.fontSize=Number(l),j.a.lineHeight=Number(i)*Number(l),j.a.drawText.apply(j.a,[v,g].concat(H))},I=function(e,t,n,a,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:T;E(t.current,a,c,l);var i=V(t.current),r=A(n.current),o=p()(e,i,r.data,N,S,y);return[o,r]},J=function(){var e=Object(a.useState)("Georgia"),t=Object(b.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(F),i=Object(b.a)(l,2),r=i[0],f=i[1],j=Object(a.useState)(v),m=Object(b.a)(j,2),p=m[0],y=m[1],k=Object(a.useState)(20),M=Object(b.a)(k,2),R=M[0],B=M[1],W=Object(a.useState)(1.1),H=Object(b.a)(W,2),A=H[0],J=H[1],U=Object(a.useState)(w),P=Object(b.a)(U,2),G=P[0],K=P[1],Q=Object(a.useState)(0),X=Object(b.a)(Q,2),Y=X[0],Z=X[1],$=Object(a.useState)(0),_=Object(b.a)($,2),ee=_[0],te=_[1],ne=Object(a.useState)(C),ae=Object(b.a)(ne,2),ce=ae[0],le=ae[1],ie=Object(a.useRef)(null),re=Object(a.useRef)(null),oe=Object(a.useRef)(null),se=Object(a.useRef)(null),ue=Object(a.useRef)(null);Object(a.useEffect)((function(){L(oe.current)}),[]),Object(a.useEffect)((function(){E(se.current,p,{fontFamily:n,fontSize:R,fontWeight:G,lineHeight:A,wordSpacing:h(ee),letterSpacing:h(Y),textTransform:ce},z)}),[n,R,A,Y,ee,G,ce,p]),Object(a.useEffect)((function(){E(ue.current,p,{fontFamily:r,fontSize:R,lineHeight:A,fontWeight:G,textTransform:ce},T)}),[r,R,A,ce,G,p]);var de=function(){var e=Object(d.a)(o.a.mark((function e(){var t,a,c,l,i,d,f,j,m,g,v,y,N,S,w,F,C,k,M,T,B,W,H,J,U,P;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,ie.current.style.display="block",oe.current.style.opacity=1,L(se.current),a={fontSize:R,lineHeight:A,fontWeight:G},c=Object(u.a)(Object(u.a)({},a),{},{fontFamily:r}),l=Object(u.a)(Object(u.a)({},a),{},{fontFamily:n,letterSpacing:h(Y),wordSpacing:h(ee)}),E(se.current,q(p,ce),l,z),i=V(se.current),d=.2*Number(R),f=-d,j=d,m=.2*Number(R),y=.01,N=(j-f)/10,S=((v=m)-(g=-m))/10,w={x:0,y:0};case 19:if(!(N>y&&S>y)){e.next=36;break}if(F=[{x:w.x,y:w.y-S},{x:w.x-N,y:w.y},{x:w.x,y:w.y},{x:w.x+N,y:w.y},{x:w.x,y:w.y+S}].map((function(e){var t=e.x,n=e.y;return{x:Math.round(100*x(t,f,j))/100,y:Math.round(100*x(n,g,v))/100}})),C=F.map((function(e){var t=e.x,n=e.y;return I(i,ue,oe,q(p,ce),Object(u.a)(Object(u.a)({},c),{},{letterSpacing:h(t),wordSpacing:h(n)}))})).reduce((function(e,t){return[[].concat(Object(s.a)(e[0]),[t[0]]),[].concat(Object(s.a)(e[1]),[t[1]])]}),[[],[]]),k=Object(b.a)(C,2),M=k[0],T=k[1],B=Math.min.apply(Math,Object(s.a)(M)),W=M.indexOf(B),H=F[W],w===H){e.next=30;break}return o=oe.current,K=T[W],o.getContext("2d").putImageData(K,0,0),re.current.innerText="In Progress: Minimization Round ".concat(t,"\n").concat(JSON.stringify({letterSpacing:h(H.x),wordSpacing:h(H.y)})),e.next=30,O(.16666666666666666);case 30:w=H,t++,N*=Math.pow(.999,t),S*=Math.pow(.999,t),e.next=19;break;case 36:U=(J=w).x,P=J.y,D(oe.current,q(p,ce),n,r,Object(u.a)(Object(u.a)({},a),{},{letterSpacingOriginal:h(Y),wordSpacingOriginal:h(ee),letterSpacing:h(U),wordSpacing:h(P)})),re.current.innerText="Done on Minimization Round ".concat(t,"\n").concat(JSON.stringify({letterSpacing:h(U),wordSpacing:h(P)}));case 39:case"end":return e.stop()}var o,K}),e)})));return function(){return e.apply(this,arguments)}}(),be=function(e,t){var n=t.target.value;e((function(){return n}))};return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsxs)("header",{className:"header",children:[Object(g.jsx)("h1",{className:"headline",children:"Auto Fallback Font Matcher"}),Object(g.jsx)("p",{children:Object(g.jsx)("em",{children:"* only tested in Chrome"})})]}),Object(g.jsxs)("main",{className:"content",children:[Object(g.jsxs)("div",{className:"config mb-4",children:[Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsxs)("label",{htmlFor:"font-size",className:"form-label",children:["Font Size",Object(g.jsx)("sup",{children:Object(g.jsx)("em",{children:"(px)"})})]}),Object(g.jsx)("input",{onBlur:be.bind(null,B),className:"form-control",id:"font-size",type:"number",step:"1",defaultValue:20})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsxs)("label",{htmlFor:"line-height",className:"form-label",children:["Line Height",Object(g.jsx)("sup",{children:Object(g.jsx)("em",{children:"(unitless, relative)"})})]}),Object(g.jsx)("input",{onBlur:be.bind(null,J),className:"form-control",id:"line-height",type:"number",step:"0.01",defaultValue:1.1})]})]}),Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-weight",className:"form-label",children:"Font Weight"}),Object(g.jsxs)("select",{onChange:be.bind(null,K),className:"form-control form-select",id:"font-weight",defaultValue:w,children:[Object(g.jsx)("option",{value:"100",children:"100"}),Object(g.jsx)("option",{value:"200",children:"200"}),Object(g.jsx)("option",{value:"300",children:"300"}),Object(g.jsx)("option",{value:"400",children:"400"}),Object(g.jsx)("option",{value:"500",children:"500"}),Object(g.jsx)("option",{value:"600",children:"600"}),Object(g.jsx)("option",{value:"700",children:"700"}),Object(g.jsx)("option",{value:"800",children:"800"}),Object(g.jsx)("option",{value:"900",children:"900"})]})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"text-transform",className:"form-label",children:"Text Transform"}),Object(g.jsxs)("select",{onChange:be.bind(null,le),className:"form-control form-select",id:"text-transform",defaultValue:C,children:[Object(g.jsx)("option",{value:"none",children:"None"}),Object(g.jsx)("option",{value:"uppercase",children:"Uppercase"}),Object(g.jsx)("option",{value:"lowercase",children:"Lowercase"})]})]})]}),Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsxs)("label",{htmlFor:"letter-spacing",className:"form-label",children:["Letter Spacing",Object(g.jsx)("sup",{children:Object(g.jsx)("em",{children:"(px, webfont only)"})})]}),Object(g.jsx)("input",{onBlur:be.bind(null,Z),className:"form-control",id:"letter-spacing",type:"number",step:"0.01",defaultValue:0})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsxs)("label",{htmlFor:"word-spacing",className:"form-label",children:["Word Spacing",Object(g.jsx)("sup",{children:Object(g.jsx)("em",{children:"(px, webfont only)"})})]}),Object(g.jsx)("input",{onBlur:be.bind(null,te),className:"form-control",id:"word-spacing",type:"number",step:"0.01",defaultValue:0})]})]}),Object(g.jsxs)("div",{className:"config-field col-12",children:[Object(g.jsx)("label",{className:"form-label",htmlFor:"font-text",children:"Text"}),Object(g.jsx)("textarea",{onBlur:be.bind(null,y),className:"form-control text",id:"font-text",defaultValue:v})]}),Object(g.jsx)("hr",{className:"my-4"}),Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-webfont",className:"form-label",children:"Webfont Family"}),Object(g.jsxs)("div",{className:"input-group",children:[Object(g.jsx)("input",{style:{fontFamily:n},className:"form-control",id:"font-webfont",type:"text",value:n,onChange:be.bind(null,c),onBlur:be.bind(null,c)}),Object(g.jsxs)("label",{htmlFor:"uploadFont",className:"input-group-text upload-icon btn-primary",children:[Object(g.jsx)("input",{type:"file",accept:".ttf,.otf,.woff,.woff2,.svg",className:"uploadFont",onChange:function(e){if(e.target.files){var t=Object(b.a)(e.target.files,1)[0];t&&function(e,t){var n=e.name.split("."),a=Object(b.a)(n,1)[0],c=URL.createObjectURL(e),l=document.createElement("style");l.textContent='\n      @font-face {\n        font-family: "'.concat(a,'";\n        src: url(').concat(JSON.stringify(c),");\n      }\n    "),document.head.appendChild(l),t(a)}(t,c)}},id:"uploadFont"}),Object(g.jsx)("span",{children:"\u21eb"})]})]})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-fallback",className:"form-label",children:"Fallback Family"}),Object(g.jsx)("input",{style:{fontFamily:r},className:"form-control",id:"font-fallback",type:"text",defaultValue:F,onBlur:be.bind(null,f)})]})]}),Object(g.jsx)("button",{className:"btn btn-primary",onClick:de,children:"Start Auto Match"})]}),Object(g.jsx)("div",{className:"result mb-4",ref:re}),Object(g.jsxs)("div",{ref:ie,className:"drawArea",children:[Object(g.jsx)("canvas",{ref:se,className:"canvas",width:N,height:S,id:"webfont"}),Object(g.jsx)("canvas",{ref:ue,className:"canvas",width:N,height:S,id:"fallback"}),Object(g.jsx)("canvas",{ref:oe,className:"canvas",width:N,height:S,id:"diff"})]})]})]})};i.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(J,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.0f22d0c1.chunk.js.map