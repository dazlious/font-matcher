(this["webpackJsonpfont-matcher"]=this["webpackJsonpfont-matcher"]||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),i=n(11),l=n.n(i),r=(n(18),n(19),n(20),n(9)),o=n.n(r),s=n(7),u=n(3),f=n(12),d=n(4),b=n(1),m=n.n(b),j=n(13),p=n.n(j),h=function(e){return"".concat(e,"px")},x=function(e,t,n){return Math.min(Math.max(e,t),n)},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){return setTimeout(t,e)}))},g=(n(27),n(0)),y="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";m.a.vAlign="top",m.a.align="left",m.a.justify=!1;var v={threshold:.2,includeAA:!0,diffMask:!1},N=500,S=400,w="0px",F="0px",k="Times New Roman",M="#fff",z="#000",C="#FFF9B3",R="#B3FFCB",B=[0,0,N,S],H=[20,20,460,360],T=function(e){var t=e.getContext("2d");return t.getImageData.apply(t,B).data},A=function(e){var t=e.getContext("2d");return t.clearRect.apply(t,B),t.createImageData(N,S)},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,n=e.getContext("2d");n.clearRect.apply(n,B),n.fillStyle=t,n.fillRect.apply(n,B)},q=function(e,t,n,a){var c=n.fontFamily,i=n.fontSize,l=n.lineHeight,r=n.letterSpacing,o=void 0===r?w:r,s=n.wordSpacing,u=void 0===s?F:s,f=e.getContext("2d");E(e,a),e.style.letterSpacing=o,e.style.wordSpacing=u,f.fillStyle=z,m.a.font=c,m.a.fontSize=Number(i),m.a.lineHeight=Number(l)*Number(i),m.a.drawText.apply(m.a,[f,t].concat(H))},D=function(e,t,n,a,c){var i=c.fontSize,l=c.lineHeight,r=c.letterSpacing,o=void 0===r?w:r,s=c.wordSpacing,u=void 0===s?F:s,f=e.getContext("2d");E(e,M),f.fillStyle=z,e.style.letterSpacing=w,e.style.wordSpacing=F,m.a.font=n,m.a.fontSize=Number(i),m.a.lineHeight=Number(l)*Number(i),m.a.drawText.apply(m.a,[f,t].concat(H)),e.style.letterSpacing=o,e.style.wordSpacing=u,f.fillStyle="#ff0000",m.a.font=a,m.a.fontSize=Number(i),m.a.lineHeight=Number(l)*Number(i),m.a.drawText.apply(m.a,[f,t].concat(H))},I=function(e,t,n,a,c){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:C;q(t.current,a,c,i);var l=T(t.current),r=A(n.current),o=p()(e,l,r.data,N,S,v);return[o,r]},J=function(){var e=Object(a.useState)("Georgia"),t=Object(d.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(k),l=Object(d.a)(i,2),r=l[0],b=l[1],m=Object(a.useState)(y),j=Object(d.a)(m,2),p=j[0],v=j[1],w=Object(a.useState)(20),F=Object(d.a)(w,2),M=F[0],z=F[1],B=Object(a.useState)(1.1),H=Object(d.a)(B,2),A=H[0],J=H[1],L=Object(a.useRef)(null),V=Object(a.useRef)(null),U=Object(a.useRef)(null),P=Object(a.useRef)(null),G=Object(a.useRef)(null);Object(a.useEffect)((function(){E(U.current)}),[]),Object(a.useEffect)((function(){q(P.current,p,{fontFamily:n,fontSize:M,lineHeight:A},R)}),[n,M,A,p]),Object(a.useEffect)((function(){q(G.current,p,{fontFamily:r,fontSize:M,lineHeight:A},C)}),[r,M,A,p]);var W=function(){var e=Object(f.a)(o.a.mark((function e(){var t,a,c,i,l,f,b,m,j,g,y,v,N,S,w,F,k,z,C,B,H,J,W,K,Q,X;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,L.current.style.display="block",U.current.style.opacity=1,E(P.current),a={fontSize:M,lineHeight:A},c=Object(u.a)(Object(u.a)({},a),{},{fontFamily:r}),i=Object(u.a)(Object(u.a)({},a),{},{fontFamily:n}),q(P.current,p,i,R),l=T(P.current),f=.3*Number(M),b=-f,m=f,j=.3*Number(M),v=.01,N=(m-b)/10,S=((y=j)-(g=-j))/10,w={x:0,y:0};case 19:if(!(N>v&&S>v)){e.next=36;break}if(F=[{x:w.x,y:w.y-S},{x:w.x-N,y:w.y},{x:w.x,y:w.y},{x:w.x+N,y:w.y},{x:w.x,y:w.y+S}].map((function(e){var t=e.x,n=e.y;return{x:Math.round(100*x(t,b,m))/100,y:Math.round(100*x(n,g,y))/100}})),k=F.map((function(e){var t=e.x,n=e.y;return I(l,G,U,p,Object(u.a)(Object(u.a)({},c),{},{letterSpacing:h(t),wordSpacing:h(n)}))})).reduce((function(e,t){return[[].concat(Object(s.a)(e[0]),[t[0]]),[].concat(Object(s.a)(e[1]),[t[1]])]}),[[],[]]),z=Object(d.a)(k,2),C=z[0],B=z[1],H=Math.min.apply(Math,Object(s.a)(C)),J=C.indexOf(H),W=F[J],w===W){e.next=30;break}return o=U.current,Y=B[J],o.getContext("2d").putImageData(Y,0,0),V.current.innerText="In Progress\nMinimization Round ".concat(t,"\n").concat(JSON.stringify({letterSpacing:h(W.x),wordSpacing:h(W.y)})),e.next=30,O(.16666666666666666);case 30:w=W,t++,N*=Math.pow(.999,t),S*=Math.pow(.999,t),e.next=19;break;case 36:Q=(K=w).x,X=K.y,D(U.current,p,n,r,Object(u.a)(Object(u.a)({},a),{},{letterSpacing:h(Q),wordSpacing:h(X)})),V.current.innerText="Done\nMinimization Round ".concat(t,"\n").concat(JSON.stringify({letterSpacing:h(Q),wordSpacing:h(X)}));case 39:case"end":return e.stop()}var o,Y}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(e,t){var n=t.target.value;e((function(){return n}))};return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsxs)("header",{className:"header",children:[Object(g.jsx)("h1",{className:"headline",children:"Auto Fallback Font Matcher"}),Object(g.jsx)("p",{children:Object(g.jsx)("em",{children:"* only tested in Chrome"})})]}),Object(g.jsxs)("main",{className:"content",children:[Object(g.jsxs)("div",{className:"config mb-4",children:[Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"line-height",className:"form-label",children:"Line Height"}),Object(g.jsx)("input",{onBlur:K.bind(null,J),className:"form-control",id:"line-height",type:"number",defaultValue:1.1})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-size",className:"form-label",children:"Font Size"}),Object(g.jsx)("input",{onBlur:K.bind(null,z),className:"form-control",id:"font-size",type:"number",defaultValue:20})]})]}),Object(g.jsxs)("div",{className:"config-field col-12",children:[Object(g.jsx)("label",{className:"form-label",htmlFor:"font-text",children:"Text"}),Object(g.jsx)("textarea",{onBlur:K.bind(null,v),className:"form-control text",id:"font-text",defaultValue:y})]}),Object(g.jsx)("hr",{className:"my-4"}),Object(g.jsxs)("div",{className:"row mb-4",children:[Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-webfont",className:"form-label",children:"Webfont Family"}),Object(g.jsxs)("div",{className:"input-group",children:[Object(g.jsx)("input",{style:{fontFamily:n},className:"form-control",id:"font-webfont",type:"text",value:n,onChange:K.bind(null,c),onBlur:K.bind(null,c)}),Object(g.jsxs)("label",{htmlFor:"uploadFont",className:"input-group-text upload-icon btn-primary",children:[Object(g.jsx)("input",{type:"file",accept:".ttf,.otf,.woff,.woff2,.svg",className:"uploadFont",onChange:function(e){!function(e,t){var n=e.name.split("."),a=Object(d.a)(n,1)[0],c=URL.createObjectURL(e),i=document.createElement("style");i.textContent='\n      @font-face {\n        font-family: "'.concat(a,'";\n        src: url(').concat(JSON.stringify(c),");\n      }\n    "),document.head.appendChild(i),t(a)}(e.target.files[0],c)},id:"uploadFont"}),Object(g.jsx)("span",{children:"\u21eb"})]})]})]}),Object(g.jsxs)("div",{className:"config-field col-6",children:[Object(g.jsx)("label",{htmlFor:"font-fallback",className:"form-label",children:"Fallback Family"}),Object(g.jsx)("input",{style:{fontFamily:r},className:"form-control",id:"font-fallback",type:"text",defaultValue:k,onBlur:K.bind(null,b)})]})]}),Object(g.jsx)("button",{className:"btn btn-primary",onClick:W,children:"Start Auto Match"})]}),Object(g.jsx)("div",{className:"result mb-4",ref:V}),Object(g.jsxs)("div",{ref:L,className:"drawArea",children:[Object(g.jsx)("canvas",{ref:P,className:"canvas",width:N,height:S,id:"webfont"}),Object(g.jsx)("canvas",{ref:G,className:"canvas",width:N,height:S,id:"fallback"}),Object(g.jsx)("canvas",{ref:U,className:"canvas",width:N,height:S,id:"diff"})]})]})]})};l.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(J,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.a1f5ee03.chunk.js.map